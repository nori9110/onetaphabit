(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5700:function(e,t,a){Promise.resolve().then(a.bind(a,6110))},6110:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return I}});var s=a(7437),r=a(2265),n=a(7042),l=a(4769);function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,l.m6)((0,n.W)(t))}function d(e){let{value:t,size:a=100,strokeWidth:r=4,className:n}=e,l=(a-r)/2,d=2*Math.PI*l;return(0,s.jsx)("div",{className:i("relative",n),style:{width:a,height:a},children:(0,s.jsxs)("svg",{className:"transform -rotate-90",width:a,height:a,children:[(0,s.jsx)("circle",{className:"text-gray-200",stroke:"currentColor",strokeWidth:r,fill:"none",cx:a/2,cy:a/2,r:l}),(0,s.jsx)("circle",{className:"transition-all duration-300 ease-in-out",stroke:"currentColor",strokeWidth:r,strokeDasharray:d,strokeDashoffset:(100-t)/100*d,strokeLinecap:"round",fill:"none",cx:a/2,cy:a/2,r:l})]})})}var c=a(3474),o=a(6061);let m=(0,o.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",ghost:"hover:bg-accent hover:text-accent-foreground",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),x=r.forwardRef((e,t)=>{let{className:a,variant:r,size:n,asChild:l=!1,...d}=e,o=l?c.g7:"button";return(0,s.jsx)(o,{className:i(m({variant:r,size:n,className:a})),ref:t,...d})});x.displayName="Button";let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:i("rounded-lg bg-card text-card-foreground shadow-sm",a),...r})});u.displayName="Card";let f=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:i("flex flex-col space-y-1.5 p-6",a),...r})});f.displayName="CardHeader";let y=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("h3",{ref:t,className:i("text-2xl font-semibold leading-none tracking-tight",a),...r})});y.displayName="CardTitle";let h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("p",{ref:t,className:i("text-sm text-muted-foreground",a),...r})});h.displayName="CardDescription";let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:i("p-6 pt-0",a),...r})});p.displayName="CardContent";let g=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:i("flex items-center p-6 pt-0",a),...r})});g.displayName="CardFooter";var N=a(7346),j=a(8244),b=a(9409);let v=r.forwardRef((e,t)=>{let{className:a,type:r,...n}=e;return(0,s.jsx)("input",{type:r,className:i("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...n})});v.displayName="Input";var D=a(1274),k=a(2549);let w=D.fC;D.xz;let Z=D.h_;D.x8;let C=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(D.aV,{ref:t,className:i("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});C.displayName=D.aV.displayName;let M=r.forwardRef((e,t)=>{let{className:a,children:r,...n}=e;return(0,s.jsxs)(Z,{children:[(0,s.jsx)(C,{}),(0,s.jsxs)(D.VY,{ref:t,className:i("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...n,children:[r,(0,s.jsxs)(D.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(k.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});M.displayName=D.VY.displayName;let R=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:i("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};R.displayName="DialogHeader";let P=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(D.Dx,{ref:t,className:i("text-lg font-semibold leading-none tracking-tight",a),...r})});P.displayName=D.Dx.displayName;let E=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(D.dk,{ref:t,className:i("text-sm text-muted-foreground",a),...r})});E.displayName=D.dk.displayName;var S=a(9991),A=a(143),T=a(4334),O=a(6754),H=a(3775),z=a(4652),F=a(5849),_=a(1424);let V=["その調子！続けていきましょう！\uD83D\uDC4D","素晴らしい進捗です！\uD83D\uDCAA","一歩一歩、着実に前進していますね！\uD83C\uDF1F","今日も目標達成、すごいです！✨","継続は力なり！頑張っています！\uD83C\uDFAF"];function I(){let[e,t]=(0,r.useState)(()=>{let e=new Date;return{name:"",progress:0,streak:0,bestStreak:0,startDate:(0,S.ZP)(e,"yyyy-MM-dd"),endDate:(0,S.ZP)((0,T.Z)(e,30),"yyyy-MM-dd"),currentDays:0,defaultPeriodDays:30,dailyRecords:{},reminderTime:"09:00",reminderEnabled:!1,periodHistory:[]}}),[a,n]=(0,r.useState)(!1),[l,i]=(0,r.useState)(""),[c,o]=(0,r.useState)(!1),[m,f]=(0,r.useState)(e.startDate),[y,h]=(0,r.useState)(e.endDate),[p,g]=(0,r.useState)(!1);(0,r.useEffect)(()=>{{let e=localStorage.getItem("habitData");e&&t(JSON.parse(e))}},[]),(0,r.useEffect)(()=>{localStorage.setItem("habitData",JSON.stringify(e)),f(e.startDate),h(e.endDate)},[e]),(0,r.useEffect)(()=>{D(e)},[]),(0,r.useEffect)(()=>{let t;if(!e.reminderEnabled||!e.reminderTime)return;let a=()=>{let s=new Date,[r,n]=e.reminderTime.split(":").map(Number),l=new Date(s);l.setHours(r,n,0,0),s>l&&l.setDate(l.getDate()+1);let i=l.getTime()-s.getTime();t=setTimeout(()=>{"granted"===Notification.permission?new Notification("習慣の記録",{body:"".concat(e.name,"の記録を忘れずに！"),icon:"/favicon.ico"}):"denied"!==Notification.permission&&Notification.requestPermission(),a()},i)};return a(),()=>{t&&clearTimeout(t)}},[e.reminderEnabled,e.reminderTime,e.name]);let D=e=>{if(!e.name||0===Object.keys(e.dailyRecords).length)return;let t=new Date,a=Object.keys(e.dailyRecords).sort().pop();if(!a)return;let s=(0,z.Z)(a),r=(0,A.Z)(t,s);r>=2&&_.Am.warning("".concat(e.name,"の記録が").concat(r,"日間途絶えています。\n今日から再開しましょう！"),{duration:5e3,position:"top-center"})},k=()=>{let e=Math.floor(Math.random()*V.length);return V[e]},Z=()=>(0,A.Z)((0,z.Z)(e.endDate),(0,z.Z)(e.startDate))+1,C=()=>{l.trim()&&(t(e=>({...e,name:l.trim()})),n(!1),console.log("目標を設定しました:",l.trim()))},E=e=>e.completed?100:0;return(0,s.jsxs)("main",{className:"min-h-screen bg-background px-4 py-6",children:[(0,s.jsx)(_.x7,{}),(0,s.jsxs)("div",{className:"container mx-auto max-w-md",children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold text-center text-sky-700 mb-8",children:"習慣の記録"}),(0,s.jsxs)(u,{className:"p-6 mb-8",children:[(0,s.jsx)("div",{className:"text-center mb-6",children:a?(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,s.jsx)(v,{type:"text",value:l,onChange:e=>i(e.target.value),onKeyPress:e=>{"Enter"===e.key&&C()},placeholder:"目標を入力",className:"max-w-[200px]",autoFocus:!0}),(0,s.jsx)(x,{variant:"default",onClick:C,className:"bg-sky-600 hover:bg-sky-700 text-white",children:"設定"})]}):(0,s.jsx)("h2",{className:"text-xl font-medium cursor-pointer hover:text-sky-600 transition-colors",onClick:()=>{i(e.name),n(!0)},children:e.name||"目標を設定してください"})}),(0,s.jsxs)("div",{className:"relative w-48 h-48 mx-auto mb-6 cursor-pointer transition-transform hover:scale-105",onClick:()=>{if(!e.name){_.Am.error("目標が設定されていません");return}let a=new Date,s=(0,z.Z)(e.startDate),r=(0,z.Z)(e.endDate);if((0,H.Z)(a,s)){_.Am.error("開始日前です");return}if((0,O.Z)(a,r)){_.Am.error("期間が終了しています");return}let n=(0,S.ZP)(a,"yyyy-MM-dd"),l=Object.values(e.dailyRecords).reduce((e,t)=>e+t,0),i=(e.dailyRecords[n]||0)+1,d=Math.min(l+1,Z()),c=Z(),o=d/c*100;if(d>=c){let a=e.streak+1,s=Math.max(a,e.bestStreak),l={startDate:e.startDate,endDate:e.endDate,dailyRecords:e.dailyRecords,completed:!0};_.Am.success("\uD83C\uDF89 期間達成おめでとうございます！",{description:"".concat(a,"期連続達成！次の期間も頑張りましょう！"),duration:5e3});let i=(0,S.ZP)((0,T.Z)(r,1),"yyyy-MM-dd"),d=(0,S.ZP)((0,T.Z)(r,e.defaultPeriodDays),"yyyy-MM-dd");t(e=>({...e,progress:0,currentDays:0,streak:a,bestStreak:s,startDate:i,endDate:d,dailyRecords:{[n]:1},periodHistory:[...e.periodHistory,l]}))}else _.Am.success("".concat(k(),"\n").concat(d,"日目 ").concat(i,"回目の達成です！"),{duration:3e3}),t(e=>({...e,progress:o,currentDays:d,dailyRecords:{...e.dailyRecords,[n]:i}}))},children:[(0,s.jsx)(d,{value:e.progress,size:192,strokeWidth:8,className:"text-sky-500"}),(0,s.jsxs)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center",children:[(0,s.jsxs)("span",{className:"text-4xl font-bold text-sky-700",children:[Math.round(e.progress),"%"]}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"達成率"}),(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[e.currentDays,"/",Z(),"日"]})]})]}),(0,s.jsx)("div",{className:"text-center mb-4",children:(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["期間: ","".concat((0,S.ZP)((0,z.Z)(e.startDate),"M月d日",{locale:F.ja}),"〜").concat((0,S.ZP)((0,z.Z)(e.endDate),"M月d日",{locale:F.ja}))]})}),(0,s.jsxs)("div",{className:"text-center mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,s.jsx)("span",{className:"text-sky-600",children:"\uD83D\uDD25"}),(0,s.jsxs)("span",{className:"text-lg",children:[e.streak,"期連続達成中"]})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["最高記録: ",e.bestStreak,"期"]})]}),e.name&&(0,s.jsx)("p",{className:"text-sm text-center text-gray-500 mt-2",children:"円をクリックして1日分の達成を記録"})]}),(0,s.jsx)(w,{open:c,onOpenChange:o,children:(0,s.jsxs)(M,{children:[(0,s.jsx)(R,{children:(0,s.jsx)(P,{children:"期間設定"})}),(0,s.jsxs)("div",{className:"py-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"開始日"}),(0,s.jsx)(v,{type:"date",value:m,onChange:t=>{let a=t.target.value;if(f(a),e.defaultPeriodDays){let t=(0,z.Z)(a);h((0,S.ZP)((0,T.Z)(t,e.defaultPeriodDays-1),"yyyy-MM-dd"))}},className:"w-full"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"終了日"}),(0,s.jsx)(v,{type:"date",value:y,onChange:e=>h(e.target.value),className:"w-full"})]})]}),(0,s.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"リマインド通知"}),(0,s.jsx)(x,{variant:"ghost",onClick:()=>{"granted"!==Notification.permission&&Notification.requestPermission(),t(e=>({...e,reminderEnabled:!e.reminderEnabled}))},className:"".concat(e.reminderEnabled?"text-sky-600":"text-gray-400"),children:e.reminderEnabled?"通知オン":"通知オフ"})]}),e.reminderEnabled&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"通知時間"}),(0,s.jsx)(v,{type:"time",value:e.reminderTime,onChange:e=>t(t=>({...t,reminderTime:e.target.value})),className:"w-full"})]})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-4 text-center",children:["現在の期間設定: ",e.defaultPeriodDays,"日"]}),(0,s.jsx)(x,{className:"w-full mt-6 bg-sky-600 hover:bg-sky-700 text-white",onClick:()=>{let e=(0,z.Z)(m),a=(0,z.Z)(y);if((0,O.Z)(e,a)){_.Am.error("開始日は終了日より前の日付を選択してください");return}let s=(0,A.Z)(a,e)+1;t(e=>({...e,startDate:m,endDate:y,defaultPeriodDays:s,currentDays:Math.min(e.currentDays,s),progress:Math.min(e.currentDays/s*100,100)})),o(!1),_.Am.success("期間を".concat(s,"日に設定しました"))},children:"設定を保存"})]})]})}),(0,s.jsx)(w,{open:p,onOpenChange:g,children:(0,s.jsxs)(M,{className:"max-w-md",children:[(0,s.jsx)(R,{children:(0,s.jsx)(P,{children:"実施記録"})}),(0,s.jsx)("div",{className:"py-4 max-h-[60vh] overflow-y-auto",children:0===e.periodHistory.length?(0,s.jsx)("p",{className:"text-center text-gray-500",children:"記録がありません"}):(0,s.jsx)("div",{className:"space-y-4",children:[...e.periodHistory].reverse().map((t,a)=>(0,s.jsxs)(u,{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsxs)("span",{className:"text-sm font-medium",children:["第",e.periodHistory.length-a,"期"]}),(0,s.jsx)("span",{className:"text-sm ".concat(t.completed?"text-sky-600":"text-gray-500"),children:t.completed?"達成":"未達成"})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["期間: ",(0,S.ZP)((0,z.Z)(t.startDate),"M月d日",{locale:F.ja}),"〜",(0,S.ZP)((0,z.Z)(t.endDate),"M月d日",{locale:F.ja})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["達成率: ",E(t),"%"]}),(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["記録回数: ",Object.values(t.dailyRecords).reduce((e,t)=>e+t,0),"回"]})]})]},a))})})]})}),(0,s.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-4 py-3",children:(0,s.jsx)("div",{className:"container mx-auto max-w-md",children:(0,s.jsxs)("div",{className:"flex justify-around",children:[(0,s.jsxs)(x,{variant:"ghost",className:"flex flex-col items-center gap-1",children:[(0,s.jsx)(N.Z,{className:"w-6 h-6 text-sky-600"}),(0,s.jsx)("span",{className:"text-xs text-sky-600",children:"ホーム"})]}),(0,s.jsxs)(x,{variant:"ghost",className:"flex flex-col items-center gap-1",onClick:()=>g(!0),children:[(0,s.jsx)(j.Z,{className:"w-6 h-6 text-gray-400"}),(0,s.jsx)("span",{className:"text-xs text-gray-400",children:"履歴"})]}),(0,s.jsxs)(x,{variant:"ghost",className:"flex flex-col items-center gap-1",onClick:()=>o(!0),children:[(0,s.jsx)(b.Z,{className:"w-6 h-6 text-gray-400"}),(0,s.jsx)("span",{className:"text-xs text-gray-400",children:"設定"})]})]})})})]})]})}}},function(e){e.O(0,[208,971,864,744],function(){return e(e.s=5700)}),_N_E=e.O()}]);